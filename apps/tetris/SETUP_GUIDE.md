# テトリスアプリ セットアップガイド

このガイドでは、提示された作業手順に沿って実装された内容を確認し、ローカルでの起動確認方法を説明します。

## ✅ 実装完了項目

### 1. 環境構築 ✅
- `apps/tetris` フォルダを作成
- Next.js 16.1.4 をクリーンインストール
- TypeScript、Tailwind CSS、ESLint を設定
- App Router を使用

### 2. 基本構造 ✅
- `src/app/page.tsx`: ゲームのメイン画面
- `src/components/Tetris.tsx`: テトリス専用コンポーネント（完全実装）

### 3. スマホ/PWA設定 ✅
- `public/manifest.json`: PWAマニフェストファイル
- `src/app/layout.tsx`: PWA用メタタグ設定
  - viewport設定
  - Apple Web App設定
  - theme-color設定
- AWS Amplify配信に対応

### 4. ゲームロジック実装 ✅
- ✅ 7種類のテトリミノ（I, O, T, S, Z, J, L）
- ✅ ミノの移動（左・右・下）
- ✅ ミノの回転（時計回り）
- ✅ 衝突判定（壁・既存ブロック）
- ✅ ライン消去機能
- ✅ スコア計算（レベル連動）
- ✅ レベルシステム（10ラインごとにレベルアップ）
- ✅ ゲームオーバー判定

### 5. UI/UX調整 ✅
- ✅ スマホ用の大きなタッチボタン
  - 左移動ボタン
  - 右移動ボタン
  - 回転ボタン
  - 下移動ボタン
- ✅ ネオン風ダークテーマ
- ✅ スコア・ハイスコア・レベル・ライン数表示
- ✅ 次のピースプレビュー
- ✅ 一時停止機能
- ✅ ゲームリセット機能

### 6. 接続確認 ✅
- ✅ GitHubプッシュ手順を `GIT_COMMANDS.md` に記載
- ✅ ローカル起動確認方法を以下に記載

## 🚀 ローカルでの起動確認方法

### ステップ1: 依存関係のインストール（初回のみ）

```bash
cd apps/tetris
npm install
```

### ステップ2: 開発サーバーを起動

```bash
npm run dev
```

### ステップ3: ブラウザで確認

1. ブラウザで `http://localhost:3000` を開く
2. テトリスゲームが表示されることを確認
3. スマホの場合は、開発者ツールでデバイスモードに切り替えて確認

### ステップ4: 動作確認項目

- [ ] ゲームボードが表示される
- [ ] テトリミノが自動的に落下する
- [ ] 左・右・下ボタンでミノが移動する
- [ ] 回転ボタンでミノが回転する
- [ ] ラインが揃うと消去される
- [ ] スコアが増加する
- [ ] レベルが上がる（10ラインごと）
- [ ] ハイスコアがlocalStorageに保存される
- [ ] 一時停止ボタンが機能する
- [ ] ゲームオーバー時にリセットできる

### ステップ5: PWA動作確認（オプション）

1. Chrome DevToolsを開く（F12）
2. Applicationタブを開く
3. Manifestセクションでマニフェストが読み込まれているか確認
4. Service WorkersセクションでPWA設定を確認

**注意**: PWAアイコン（`icon-192.png`, `icon-512.png`）はまだ作成されていません。PWAとして完全に動作させるには、これらのアイコンを作成する必要があります。

## 📱 スマホでの確認方法

### 方法1: ローカルネットワーク経由

1. 開発サーバーを起動: `npm run dev`
2. スマホとPCが同じWi-Fiネットワークに接続されていることを確認
3. PCのIPアドレスを確認:
   ```bash
   # macOS/Linux
   ifconfig | grep "inet "
   
   # Windows
   ipconfig
   ```
4. スマホのブラウザで `http://[PCのIPアドレス]:3000` を開く

### 方法2: ngrokを使用（推奨）

1. ngrokをインストール: `npm install -g ngrok`
2. 開発サーバーを起動: `npm run dev`
3. 別のターミナルで: `ngrok http 3000`
4. ngrokが表示するURLをスマホで開く

## 🎮 ゲームの操作方法

### デスクトップ
- キーボード操作は現在未実装（将来的に追加可能）

### スマホ
- **左ボタン**: ミノを左に移動
- **右ボタン**: ミノを右に移動
- **下ボタン**: ミノを下に移動（スコア+1）
- **回転ボタン**: ミノを時計回りに回転
- **一時停止ボタン**: ゲームを一時停止/再開
- **新しいゲームボタン**: ゲームをリセット

## 🐛 トラブルシューティング

### ポート3000が使用中の場合

```bash
# 別のポートで起動
PORT=3001 npm run dev
```

### ビルドエラーが発生する場合

```bash
# node_modulesを削除して再インストール
rm -rf node_modules package-lock.json
npm install
```

### TypeScriptエラーが発生する場合

```bash
# 型定義を確認
npm run lint
```

## 📦 プロダクションビルド

```bash
npm run build
npm run start
```

プロダクションビルドは `http://localhost:3000` で起動します。

## 🔗 次のステップ

1. PWAアイコンの作成（`public/icon-192.png`, `public/icon-512.png`）
2. GitHubへのプッシュ（`GIT_COMMANDS.md` を参照）
3. AWS Amplify Gen 2でのデプロイ準備
4. DynamoDB連携の実装（`src/app/api/score/route.ts` を完成させる）
